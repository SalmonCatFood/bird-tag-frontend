# BirdTag 前端使用说明

## 项目概述

BirdTag 是一个基于 Vue 3 开发的野生动物识别和标记平台前端应用，后端使用 AWS 云服务。

## 技术栈

- **框架**: Vue 3 (Composition API)
- **构建工具**: Vite
- **路由**: Vue Router 4
- **AWS集成**: AWS Amplify, Cognito (已准备就绪)

## 快速开始

### 1. 安装依赖

```bash
cd birdtag
npm install
```

### 2. 配置 API 端点

编辑 `src/config/api.js` 文件，填入您的 AWS API Gateway 地址：

```javascript
export const API_CONFIG = {
  // REST API 地址
  REST_API_URL: 'https://YOUR_API_ID.execute-api.YOUR_REGION.amazonaws.com/YOUR_STAGE',
  
  // WebSocket API 地址
  WEBSOCKET_API_URL: 'wss://YOUR_WS_ID.execute-api.YOUR_REGION.amazonaws.com/YOUR_STAGE',
  
  // AWS 区域
  AWS_REGION: 'YOUR_REGION',
  
  // Cognito 配置(如使用)
  COGNITO: {
    USER_POOL_ID: 'YOUR_USER_POOL_ID',
    CLIENT_ID: 'YOUR_CLIENT_ID',
    REGION: 'YOUR_REGION'
  }
}
```

### 3. 启动开发服务器

```bash
npm run dev
```

应用将在 `http://localhost:5173` 启动。

### 4. 构建生产版本

```bash
npm run build
```

构建输出将在 `dist/` 目录中。

## 项目结构

```
birdtag/
├── src/
│   ├── config/          # API 配置
│   │   └── api.js       # API 端点配置 (需要修改)
│   │
│   ├── utils/           # 工具函数
│   │   └── auth.js      # 认证工具
│   │
│   ├── services/        # 服务层
│   │   ├── api.js       # REST API 服务
│   │   └── websocket.js # WebSocket 服务
│   │
│   ├── views/           # 页面组件
│   │   ├── Login.vue    # 登录页
│   │   ├── Upload.vue   # 上传页
│   │   └── FileList.vue # 文件列表页
│   │
│   ├── router/          # 路由配置
│   │   └── index.js
│   │
│   ├── App.vue          # 主组件
│   └── main.js          # 入口文件
│
└── note/                # 文档
    ├── 前端使用说明.md  # 本文档
    ├── 项目提示词.md    # 完整项目架构
    └── 常见问题解决.md  # 常见问题
```

## 主要功能

### 1. 用户登录
- JWT 令牌管理
- 支持模拟登录(开发模式)
- 准备集成 AWS Cognito

### 2. 文件上传
- 拖放上传界面
- 支持多文件上传
- 实时上传进度显示
- WebSocket 实时更新处理状态

### 3. 文件管理
- 网格布局展示
- 按文件类型筛选
- 缩略图预览
- 显示识别标签

## 功能演示

### 登录流程
1. 访问首页自动跳转到登录页
2. 输入用户名密码(开发模式可随意输入)
3. 登录成功后跳转到上传页

### 上传流程
1. 点击或拖拽文件到上传区域
2. 自动请求预签名 URL
3. 上传文件到 S3
4. 显示上传进度
5. WebSocket 接收处理更新
6. 显示缩略图和识别结果

### 文件查看
1. 点击导航栏"My Files"
2. 查看所有上传的文件
3. 使用筛选器按类型过滤
4. 点击"View Original"查看原文件

## 路由说明

- `/` - 重定向到登录页
- `/login` - 登录页面
- `/upload` - 文件上传(需登录)
- `/files` - 文件列表(需登录)

## API 配置详解

### REST API 端点

在 `src/config/api.js` 中配置：

```javascript
export const API_ENDPOINTS = {
  UPLOAD_FILE: '/upload-file',    // 请求上传
  GET_METADATA: '/metadata',      // 获取元数据
  LIST_FILES: '/files'            // 列出文件
}
```

### 如何获取 API Gateway URL

#### REST API URL:
1. 登录 AWS 控制台
2. 进入 API Gateway 服务
3. 选择您的 REST API
4. 点击"阶段"(Stages)
5. 复制"调用 URL"

#### WebSocket URL:
1. 登录 AWS 控制台
2. 进入 API Gateway 服务
3. 选择您的 WebSocket API
4. 点击"阶段"(Stages)
5. 复制"WebSocket URL"

## 开发模式说明

### 模拟认证
当后端未配置时，登录页使用模拟认证：
- 任意用户名/密码都可登录
- 生成模拟 JWT 令牌
- 可正常访问受保护路由

### 模拟数据
文件列表页在后端未配置时显示模拟数据：
- 随机生成 6 个文件
- 显示不同文件类型
- 展示标签功能

### WebSocket 连接
- 连接失败会在控制台显示
- 应用继续正常工作
- 不会收到实时更新

## 与后端集成

### 数据流程

1. **用户登录**
   - 前端获取 JWT token
   - 保存到 localStorage
   - 用于后续请求认证

2. **文件上传**
   - 请求预签名 URL: `POST /upload-file`
   - 后端生成 S3 预签名 URL
   - 前端直接上传到 S3
   - 建立 WebSocket 连接

3. **后端处理**
   - S3 触发 Lambda 处理
   - 生成缩略图
   - 识别物种标签
   - 更新 DynamoDB

4. **实时通知**
   - DynamoDB Stream 触发
   - 推送消息到 WebSocket
   - 前端接收并更新 UI

详细流程请参考 `项目提示词.md`。

## 开发建议

### 本地开发
1. 先完成 API 配置
2. 测试 REST API 连接
3. 测试 WebSocket 连接
4. 逐功能测试

### 调试技巧
1. 打开浏览器开发者工具(F12)
2. 查看 Console 标签查看日志
3. 查看 Network 标签查看请求
4. 查看 Application > Storage 查看令牌

### 常见问题
参考 `常见问题解决.md` 文档。

## 生产部署

### 推荐方案: AWS S3 + CloudFront

1. 构建生产版本:
   ```bash
   npm run build
   ```

2. 上传到 S3:
   ```bash
   aws s3 sync dist/ s3://your-bucket-name
   ```

3. 配置 CloudFront 分发

详细部署说明请参考英文文档 `Deployment-Guide.md`。

## 自定义修改

### 修改主题颜色
编辑各组件的 `<style>` 部分，主要颜色:
- 主色: `#667eea` (紫蓝色)
- 辅色: `#764ba2` (紫色)

### 修改文本
所有界面文本都在各组件的 `<template>` 中，可直接修改。

### 添加新页面
1. 在 `src/views/` 创建新组件
2. 在 `src/router/index.js` 添加路由
3. 在 `App.vue` 导航栏添加链接

## 性能优化

- 使用 Vue 的懒加载
- 图片使用缩略图
- 启用 CloudFront CDN
- 开启 gzip 压缩

## 浏览器支持

- Chrome/Edge (最新版)
- Firefox (最新版)
- Safari (最新版)
- 移动端浏览器

## 安全注意事项

1. **不要提交敏感信息**
   - API 密钥
   - AWS 凭证
   - 用户密码

2. **使用 HTTPS**
   - 生产环境必须使用 HTTPS
   - WebSocket 使用 WSS

3. **令牌管理**
   - 定期刷新令牌
   - 安全存储令牌

## 获取帮助

### 文档资源
- **快速开始**: `Quick-Start.md` (英文)
- **开发指南**: `Frontend-Development-Guide.md` (英文)
- **项目架构**: `项目提示词.md` (中文)
- **常见问题**: `常见问题解决.md` (中文)

### 调试资源
- 浏览器控制台日志
- AWS CloudWatch 日志
- API Gateway 执行日志

## 版本信息

- Vue: 3.5.22
- Vue Router: 4.6.3
- Vite: 7.1.11
- Node.js: 20.19.0+

## 许可证

本项目是 BirdTag 野生动物识别平台的一部分。

---

**重要提示**: 首次使用前，务必先配置 `src/config/api.js` 中的 API 端点！

